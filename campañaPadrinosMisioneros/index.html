<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Campaña Temporal Padrinos</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  body { font-family: Arial, sans-serif; margin:0; }

  /* Banner */
  .campana-padrinos {
  /* Nueva imagen de fondo con una capa semitransparente para mejor legibilidad */
  background: linear-gradient(rgba(255, 204, 128, 0.8), rgba(255, 224, 128, 0.8)),
              url('./Gemini_Generated_Image_ap8di7ap8di7ap8d.png') no-repeat center center;
  background-size: cover;
  color: #4e342e;
  text-align: center;
  padding: 2em 1em;
  border-bottom: 4px solid #ff9800;
  animation: fadeIn 1s ease-in-out;
}
  .contenedor-campana { max-width: 800px; margin:auto; }
  .campana-padrinos h2 { font-size: 2em; margin-bottom:0.5em; cursor:pointer; }
  .campana-padrinos p { font-size:1.2em; margin-bottom:1.5em; }

  /* Testimonios - Carrusel */
  .testimonios {
    background-color: #fff8e1;
    padding: 3em 1em;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .testimonios h2 {
    color: #4e342e;
    font-size: 2em;
    margin-bottom: 1.5em;
    position: relative;
  }
  .testimonios h2:after {
    content: '';
    display: block;
    width: 80px;
    height: 3px;
    background: #ff6f00;
    margin: 10px auto 0;
  }
  .carrusel-contenedor {
    position: relative;
    max-width: 1000px;
    margin: 0 auto;
    overflow: hidden;
  }
  .carrusel {
    display: flex;
    transition: transform 0.5s ease-in-out;
    padding-bottom: 10px; /* Espacio para la barra de scroll */
  }
  .testimonio-tarjeta {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    min-width: 300px;
    max-width: 300px;
    margin: 0 15px;
    flex: 0 0 auto;
    position: relative;
    overflow: hidden;
  }
  .testimonio-tarjeta:before {
    content: '"';
    position: absolute;
    top: 10px;
    left: 15px;
    font-size: 4rem;
    color: #ffcc80;
    font-family: Georgia, serif;
    line-height: 1;
  }
  .testimonio-tarjeta p {
    font-style: italic;
    margin-bottom: 1.5rem;
    position: relative;
    z-index: 1;
    text-align: left;
    padding-left: 1.5rem;
  }
  .testimonio-tarjeta footer {
    font-weight: bold;
    color: #4e342e;
    text-align: right;
    font-size: 0.9rem;
  }
  .testimonio-fuente {
    display: block;
    font-weight: normal;
    font-size: 0.75rem;
    color: #8d6e63;
    margin-top: 0.3rem;
  }
  .testimonio-icono {
    font-size: 1.2rem;
    margin-right: 0.3rem;
    vertical-align: middle;
  }
  .testimonio-enlace {
    color: #ff6f00;
    text-decoration: none;
  }
  .testimonio-enlace:hover {
    text-decoration: underline;
  }
  
  /* Mejoras para el Carrusel */
  .carrusel-controls {
    margin-top: 25px;
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  .carrusel-control {
    background: #ff6f00;
    border: none;
    width: 14px;
    height: 14px;
    border-radius: 50%;
    cursor: pointer;
    opacity: 0.5;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }
  .carrusel-control.active {
    opacity: 1;
    transform: scale(1.2);
  }
  .carrusel-control:hover {
    opacity: 0.8;
    transform: scale(1.1);
  }
  .carrusel-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 111, 0, 0.9);
    color: white;
    border: none;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    font-size: 1.3rem;
    cursor: pointer;
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  }
  .carrusel-nav:hover {
    background: rgba(230, 81, 0, 0.9);
    transform: translateY(-50%) scale(1.1);
  }
  .carrusel-prev {
    left: 10px;
  }
  .carrusel-next {
    right: 10px;
  }

  /* Botones */
  .botones-campana { display:flex; justify-content:center; gap:1em; flex-wrap:wrap; margin-top:1em; }
  .btn-campana {
    background-color:#ff6f00; color:white;
    padding:0.8em 1.5em; font-weight:bold;
    border-radius:5px; text-decoration:none;
    display:inline-flex; align-items:center; justify-content:center;
    transition:0.3s; border:none; cursor:pointer;
  }
  .btn-campana:hover { background-color:#e65100; }
  .btn-campana.secundario {
    background-color:transparent; color:#4e342e; border:2px solid #ff6f00;
  }
  .btn-campana.secundario:hover { background-color:#ffcc80; color:#4e342e; }
  .btn-campana i { margin-right:0.5em; }
  .btn-accion {
    padding: 0.5em 1em;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-size: 0.8em;
  }
  .btn-editar {
    background-color: #4CAF50;
    color: white;
  }
  .btn-eliminar {
    background-color: #f44336;
    color: white;
  }
  .btn-accion:hover { opacity: 0.8; }

  @keyframes fadeIn { from {opacity:0; transform:translateY(-20px);} to {opacity:1; transform:translateY(0);} }

  /* Modal */
  .modal { 
    display: none; 
    position: fixed; 
    z-index: 999; 
    left: 0; 
    top: 0; 
    width: 100%; 
    height: 100%; 
    background: rgba(0,0,0,0.5); 
    justify-content: center; 
    align-items: center; 
  }
  .modal-content {
    background-color:#fff3e0; 
    padding:2em; 
    border-radius:10px;
    max-width:500px; 
    width:90%; 
    position:relative;
    max-height: 90vh; 
    overflow-y: auto;
  }
  .close { position:absolute; top:10px; right:15px; font-size:1.5em; cursor:pointer; }
  .modal-content input, .modal-content textarea { width:100%; padding:0.8em; margin-bottom:1em; border:1px solid #ccc; border-radius:5px; font-size:1em; }
  .modal-content textarea { resize:vertical; min-height:80px; }
  .mensaje-exito, .mensaje-error { font-weight:bold; margin-top:1em; display:none; }
  .form-group-flex {
    display: flex;
    align-items: flex-start;
    gap: 0.5em;
    margin-bottom: 1em;
  }

  /* Panel administrador */
  .panel-admin { display:none; padding:2em; background:#f5f5f5; }
  .panel-admin h2 { margin-top:0; }
  table { width:100%; border-collapse: collapse; margin-top:1em; }
  table, th, td { border:1px solid #ccc; }
  th, td { padding:0.5em; text-align:left; }

  /* Estilos responsivos para el panel administrador */
  @media (max-width: 768px) {
    .panel-admin {
      padding: 1em;
    }
    table {
      font-size: 0.9em;
      display: block;
      overflow-x: auto;
      white-space: nowrap;
    }
    th, td {
      padding: 0.4em;
    }
    .carrusel-nav {
      width: 35px;
      height: 35px;
      font-size: 1.1rem;
    }
    .testimonio-tarjeta {
      min-width: 250px;
      max-width: 250px;
      margin: 0 10px;
    }
  }

  /* Estilo para hacer la barra de scroll más visible en Webkit (Chrome, Safari) */
  .modal-content::-webkit-scrollbar {
    width: 8px;
  }
  .modal-content::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 10px;
  }
  .modal-content::-webkit-scrollbar-thumb {
    background: #ff6f00;
    border-radius: 10px;
  }
  .modal-content::-webkit-scrollbar-thumb:hover {
    background: #e65100;
  }
</style>
</head>
<body>

  <section class="campana-padrinos">
    <div class="contenedor-campana">
      <h2>Conviértete en Padrino de un Misionero</h2>
      <p>Tu generosidad puede llevar el Evangelio y la ayuda a donde más se necesita. Sé parte del cambio.</p>

      <div class="botones-campana">
        <a href="https://wa.me/526393992678?text=Hola,%20quiero%20información%20sobre%20cómo%20convertirme%20en%20padrino" 
           class="btn-campana" target="_blank" rel="noopener noreferrer">
          <i class="fab fa-whatsapp"></i> Quiero información por WhatsApp
        </a>

    <a href="https://www.misionerosdeguadalupe.org" 
           class="btn-campana secundario" target="_blank" rel="noopener noreferrer">
          Conocer Más
        </a>
      </div>
      <div class="botones-campana" style="margin-top: 0.5em;">
      <a href="faq.html" target="_blank" rel="noopener noreferrer" style="color: #4e342e; font-size: 0.9em;">Preguntas Frecuentes</a>
      </div>
    </div>
  </section>

  <section class="testimonios">
    <div class="contenedor-campana">
      <h2>Historias que inspiran</h2>
      <p style="color: #6d4c41; margin-bottom: 20px; font-style: italic;">
        Utiliza los botones o desliza para ver más testimonios
      </p>
      
      <div class="carrusel-contenedor">
        <button class="carrusel-nav carrusel-prev" aria-label="Anterior">
          <i class="fas fa-chevron-left"></i>
        </button>
        
        <div class="carrusel">
          <div class="testimonio-tarjeta">
            <p>"Cuando los misioneros llegaron a mi aldea en la Sierra Tarahumara, no traían oro ni medicinas... pero traían algo que curó mi alma: tiempo, escucha y compañía. Antes, nadie venía. Ahora sé que Dios sí llega, incluso en rarámuri."</p>
            <footer>— Damián, joven de Norogachi, Chihuahua.
              <span class="testimonio-fuente"><i class="fas fa-map-marker-alt testimonio-icono"></i>Inspirado en: La apertura de misiones de Misioneros de Guadalupe en la Sierra Tarahumara (2024).</span>
              <span class="testimonio-fuente"><i class="fas fa-link testimonio-icono"></i>Fuente: <a href="https://yucatan.com.mx/mexico/75-anos-de-obras-misioneros-de-guadalupe/" class="testimonio-enlace" target="_blank">Yucatán.com.mx - 75 años de obras</a></span>
            </footer>
            <img src="./1.png" alt="imagen relacionada" style="width: 100%; height: auto; border-radius: 8px;">

          </div>
          
          <div class="testimonio-tarjeta">
            <p>"Yo no entendía por qué ese sacerdote mexicano dejó todo para estar aquí, en mi aldea de Indonesia. Hasta que lo vi cargar sacos de arroz para los más viejos sin que nadie se lo pidiera. Ese día entendí el Evangelio sin palabras."</p>
            <footer>— Rini, joven catequista en la isla de Flores.
              <span class="testimonio-fuente"><i class="fas fa-map-marker-alt testimonio-icono"></i>Inspirado en: Misión abierta por los Misioneros de Guadalupe en Indonesia en 2024.</span>
              <span class="testimonio-fuente"><i class="fas fa-link testimonio-icono"></i>Fuente: <a href="https://yucatan.com.mx/mexico/misioneros-de-guadalupe-abren-mision-en-indonesia/" class="testimonio-enlace" target="_blank">Yucatán.com.mx - Nuevas misiones</a></span>
            </footer>
            <img src="./2.png" alt="imagen relacionada" style="width: 100%; height: auto; border-radius: 8px;">

          </div>
          
          <div class="testimonio-tarjeta">
            <p>"Nos dijeron que cada globo representaba un continente. Oramos por niños que no conocemos, pero que también necesitan a Dios. Yo no sabía que con mi oración puedo ayudar. Ahora sé que puedo ser misionera desde mi ciudad."</p>
            <footer>— Andrea, 9 años, Querétaro.
              <span class="testimonio-fuente"><i class="fas fa-map-marker-alt testimonio-icono"></i>Inspirado en: Encuentro Infantil Misionero de Querétaro con los Misioneros de Guadalupe.</span>
              <span class="testimonio-fuente"><i class="fas fa-link testimonio-icono"></i>Fuente: <a href="https://diocesisdequeretaro.com.mx/encuentro-infantil-missionero/" class="testimonio-enlace" target="_blank">Diócesis de Querétaro</a></span>
            </footer>
            <img src="./3.png" alt="imagen relacionada" style="width: 100%; height: auto; border-radius: 8px;">

          </div>
          
          <div class="testimonio-tarjeta">
            <p>"En 25 años de misión, lo más difícil no ha sido dejar mi país, sino dejar de amar. Cada rostro que he conocido es un recordatorio de que Dios sigue viajando con nosotros."</p>
            <footer>— P. Antonio del Carmen Camacho Muñoz, Misionero de Guadalupe.
              <span class="testimonio-fuente"><i class="fas fa-map-marker-alt testimonio-icono"></i>Basado en: Celebración de los 25 años de entrega misionera del P. Antonio.</span>
              <span class="testimonio-fuente"><i class="fas fa-link testimonio-icono"></i>Fuente: <a href="https://misionerosdeguadalupe.org/25-anos-del-padre-antonio-camacho/" class="testimonio-enlace" target="_blank">misionerosdeguadalupe.org</a></span>
            </footer>
            <img src="./4.png" alt="imagen relacionada" style="width: 100%; height: auto; border-radius: 8px;">

          </div>
        </div>
        
        <button class="carrusel-nav carrusel-next" aria-label="Siguiente">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
      
      <div class="carrusel-controls">
        <button class="carrusel-control active" data-index="0"></button>
        <button class="carrusel-control" data-index="1"></button>
        <button class="carrusel-control" data-index="2"></button>
        <button class="carrusel-control" data-index="3"></button>
      </div>
    </div>
  </section>

  <div class="modal" id="modal-formulario">
    <div class="modal-content">
      <span class="close" id="cerrar-modal">&times;</span>
      <h2>Deja tus datos para contactarte</h2>
      <h6>En caso de que aceptes una visita deja tu direccion en la seccion de comentarios con alguna referencia</h6>
      <form id="form-padrinos">
        <input type="text" name="nombre" placeholder="Tu nombre" required>
        <input type="email" name="correo" placeholder="Tu correo" required>
        <input type="tel" name="telefono" placeholder="Tu teléfono" required>
        <textarea name="mensaje" placeholder="Comentario (opcional)"></textarea>
        <div class="form-group-flex">
            <input type="checkbox" id="aceptar-terminos" required style="width: auto; margin-top: 0.2em;">
            <label for="aceptar-terminos" style="font-size: 0.9em;">
                Acepto el <a href="terminos.html" target="_blank" rel="noopener noreferrer" style="color: #ff6f00;">Aviso de Privacidad</a>.
            </label>
        </div>
        <button type="submit" class="btn-campana">Enviar</button>
      </form>
      <p class="mensaje-exito" id="mensaje-exito">¡Gracias! Te contactaremos pronto.</p>
    </div>
  </div>

  <div class="modal" id="modal-login">
    <div class="modal-content">
      <span class="close" id="cerrar-login">&times;</span>
      <h2>Acceso Administrador</h2>
      <form id="form-login">
        <input type="email" name="correo" placeholder="Correo" required>
        <input type="password" name="password" placeholder="Contraseña" required>
        <button type="submit" class="btn-campana">Ingresar</button>
      </form>
      <p class="mensaje-error" id="mensaje-error">Correo o contraseña incorrectos</p>
    </div>
  </div>

  <div class="modal" id="modal-editar">
    <div class="modal-content">
      <span class="close" id="cerrar-editar">&times;</span>
      <h2>Editar Prospecto</h2>
      <form id="form-editar">
        <input type="hidden" id="edit-key">
        <input type="text" name="nombre" id="edit-nombre" placeholder="Tu nombre" required>
        <input type="email" name="correo" id="edit-correo" placeholder="Tu correo" required>
        <input type="tel" name="telefono" id="edit-telefono" placeholder="Tu teléfono" required>
        <textarea name="mensaje" id="edit-mensaje" placeholder="Comentario (opcional)"></textarea>
        <button type="submit" class="btn-campana">Guardar Cambios</button>
      </form>
      <p class="mensaje-exito" id="mensaje-exito-editar">¡Cambios guardados con éxito!</p>
    </div>
  </div>

  <section class="panel-admin" id="panel-admin">
    <h2>Panel de Administrador</h2>
    <button id="btn-logout" class="btn-campana secundario">Cerrar sesión</button>
    <table id="tabla-prospectos">
      <thead>
        <tr><th>Nombre</th><th>Correo</th><th>Teléfono</th><th>Mensaje</th><th>Fecha</th><th>Acciones</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <script type="module">
    // 1. IMPORTACIONES: Todas las funciones necesarias de Firebase en una sola línea.
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";
    import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

    // 2. CONFIGURACIÓN DE FIREBASE Y VARIABLES GLOBALES
    const firebaseConfig = {
      apiKey: "AIzaSyCO3FRhSwH1xLABwVGFSd_YYrbFp0lQEv8",
      authDomain: "pagelalo-1b210.firebaseapp.com",
      databaseURL: "https://pagelalo-1b210-default-rtdb.firebaseio.com",
      projectId: "pagelalo-1b210",
      storageBucket: "pagelalo-1b210.firebasestorage.app",
      messagingSenderId: "1096735980204",
      appId: "1:1096735980204:web:8252ddb9fb484c398dfd09"
    };
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const auth = getAuth(app);

    // 3. VARIABLES Y EVENTOS DE LOS MODALES Y FORMULARIOS
    // Modal Formulario
    const modal = document.getElementById('modal-formulario');
    const btnMostrar = document.getElementById('btn-mostrar-formulario');
    const cerrarModal = document.getElementById('cerrar-modal');
    if (btnMostrar) {
      btnMostrar.addEventListener('click', () => {
        modal.style.display = 'flex';
        enviarAltura();
      });
    }
    if (cerrarModal) {
      cerrarModal.addEventListener('click', () => {
        modal.style.display = 'none';
        enviarAltura();
      });
    }
    window.addEventListener('click', (e) => { 
      if (e.target == modal) {
        modal.style.display = 'none'; 
        enviarAltura();
      }
    });

    // Guardar datos en Firebase
    const form = document.getElementById('form-padrinos');
    const mensajeExito = document.getElementById('mensaje-exito');
    if (form) {
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const datos = {
          nombre: form.nombre.value,
          correo: form.correo.value,
          telefono: form.telefono.value,
          mensaje: form.mensaje.value,
          fecha: new Date().toLocaleString()
        };
        push(ref(database, 'padrinos'), datos)
          .then(() => { 
            mensajeExito.style.display = 'block'; 
            form.reset(); 
          })
          .catch(err => alert('Error: ' + err));
      });
    }

    // Modal Login Admin
    const modalLogin = document.getElementById('modal-login');
    const cerrarLogin = document.getElementById('cerrar-login');
    const tituloBanner = document.querySelector('.campana-padrinos h2');
    const formLogin = document.getElementById('form-login');
    const mensajeError = document.getElementById('mensaje-error');
    const panel = document.getElementById('panel-admin');

    let clicks = 0, timer;
    if (tituloBanner) {
      tituloBanner.addEventListener('click', () => {
        clicks++;
        clearTimeout(timer);
        timer = setTimeout(() => { clicks = 0; }, 1500);
        if (clicks >= 5) {
          modalLogin.style.display = 'flex';
          enviarAltura();
        }
      });
    }
    if (cerrarLogin) {
      cerrarLogin.addEventListener('click', () => {
        modalLogin.style.display = 'none';
        enviarAltura();
      });
    }
    window.addEventListener('click', (e) => { 
      if (e.target == modalLogin) {
        modalLogin.style.display = 'none';
        enviarAltura();
      }
    });

    // Login con Firebase Authentication
    if (formLogin) {
      formLogin.addEventListener('submit', async (e) => {
        e.preventDefault();
        const correo = formLogin.correo.value.trim();
        const password = formLogin.password.value.trim();

        try {
          await signInWithEmailAndPassword(auth, correo, password);
          modalLogin.style.display = 'none';
          panel.style.display = 'block';
          mostrarDatosAdmin();
          enviarAltura();
        } catch (error) {
          mensajeError.style.display = 'block';
          setTimeout(() => mensajeError.style.display = 'none', 3000);
        }
      });
    }

    // Logout admin
    const btnLogout = document.getElementById('btn-logout');
    if (btnLogout) {
      btnLogout.addEventListener('click', async () => {
        try {
          await signOut(auth);
          panel.style.display = 'none';
          alert('Has cerrado sesión correctamente.');
          enviarAltura();
        } catch (error) {
          alert('Error al cerrar sesión: ' + error.message);
        }
      });
    }

    // 4. FUNCIONES DEL PANEL DE ADMINISTRACIÓN
    function mostrarDatosAdmin() {
      const tablaBody = document.querySelector('#tabla-prospectos tbody');
      const padrinosRef = ref(database, 'padrinos');
      onValue(padrinosRef, snapshot => {
        tablaBody.innerHTML = '';
        snapshot.forEach(child => {
          const key = child.key;
          const data = child.val();
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${data.nombre}</td>
            <td>${data.correo}</td>
            <td>${data.telefono}</td>
            <td>${data.mensaje}</td>
            <td>${data.fecha}</td>
            <td>
              <button class="btn-accion btn-editar" data-key="${key}">Editar</button>
              <button class="btn-accion btn-eliminar" data-key="${key}">Eliminar</button>
            </td>
          `;
          tablaBody.appendChild(tr);
        });
        enviarAltura();
      });
    }

    // 5. LÓGICA DE EDICIÓN AND ELIMINACIÓN
    // Modal de edición
    const modalEditar = document.getElementById('modal-editar');
    const cerrarEditar = document.getElementById('cerrar-editar');
    const formEditar = document.getElementById('form-editar');
    const mensajeExitoEditar = document.getElementById('mensaje-exito-editar');

    // Abrir el modal de edición y llenar el formulario
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('btn-editar')) {
        const key = e.target.dataset.key;
        const padrinoRef = ref(database, `padrinos/${key}`);
        onValue(padrinoRef, (snapshot) => {
          const data = snapshot.val();
          document.getElementById('edit-key').value = key;
          document.getElementById('edit-nombre').value = data.nombre;
          document.getElementById('edit-correo').value = data.correo;
          document.getElementById('edit-telefono').value = data.telefono;
          document.getElementById('edit-mensaje').value = data.mensaje;
          modalEditar.style.display = 'flex';
          enviarAltura();
        }, {
          onlyOnce: true
        });
      }
    });

    // Enviar formulario de edición
    if (formEditar) {
      formEditar.addEventListener('submit', (e) => {
        e.preventDefault();
        const key = document.getElementById('edit-key').value;
        const updates = {};
        updates[`/padrinos/${key}/nombre`] = document.getElementById('edit-nombre').value;
        updates[`/padrinos/${key}/correo`] = document.getElementById('edit-correo').value;
        updates[`/padrinos/${key}/telefono`] = document.getElementById('edit-telefono').value;
        updates[`/padrinos/${key}/mensaje`] = document.getElementById('edit-mensaje').value;

        update(ref(database), updates)
          .then(() => {
            mensajeExitoEditar.style.display = 'block';
            setTimeout(() => {
              mensajeExitoEditar.style.display = 'none';
              modalEditar.style.display = 'none';
              enviarAltura();
            }, 2000);
          })
          .catch((error) => {
            alert("Error al actualizar: " + error.message);
          });
      });
    }

    // Lógica de eliminación
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('btn-eliminar')) {
        const key = e.target.dataset.key;
        if (confirm('¿Estás seguro de que quieres eliminar este registro?')) {
          const padrinoRef = ref(database, `padrinos/${key}`);
          remove(padrinoRef)
            .then(() => {
              alert("Registro eliminado con éxito.");
              enviarAltura();
            })
            .catch((error) => {
              alert("Error al eliminar: " + error.message);
            });
        }
      }
    });

    // Cierre del modal de edición
    if (cerrarEditar) {
      cerrarEditar.addEventListener('click', () => {
        modalEditar.style.display = 'none';
        enviarAltura();
      });
    }
    window.addEventListener('click', (e) => {
      if (e.target == modalEditar) {
        modalEditar.style.display = 'none';
        enviarAltura();
      }
    });
  </script>

  <script>
    // Funcionalidad del carrusel
    document.addEventListener('DOMContentLoaded', function() {
      const carrusel = document.querySelector('.carrusel');
      const cards = document.querySelectorAll('.testimonio-tarjeta');
      const prevBtn = document.querySelector('.carrusel-prev');
      const nextBtn = document.querySelector('.carrusel-next');
      const controls = document.querySelectorAll('.carrusel-control');
      
      let currentIndex = 0;
      const cardWidth = cards[0].offsetWidth + 30; // Ancho de la card + margen
      let startX, endX; // Variables para el control táctil

      // Función para mover el carrusel
      function moveCarousel(index) {
        currentIndex = index;
        carrusel.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
        
        // Actualizar controles
        controls.forEach((control, i) => {
          if (i === currentIndex) {
            control.classList.add('active');
          } else {
            control.classList.remove('active');
          }
        });
      }
      
      // Event listeners para los botones de navegación
      if (prevBtn) {
        prevBtn.addEventListener('click', () => {
          let prevIndex = (currentIndex - 1 + cards.length) % cards.length;
          moveCarousel(prevIndex);
        });
      }
      
      if (nextBtn) {
        nextBtn.addEventListener('click', () => {
          let nextIndex = (currentIndex + 1) % cards.length;
          moveCarousel(nextIndex);
        });
      }
      
      // Event listeners para los controles
      controls.forEach((control, index) => {
        control.addEventListener('click', () => {
          moveCarousel(index);
        });
      });
      
      // Lógica para deslizar con el dedo en dispositivos táctiles
      carrusel.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
      });
      
      carrusel.addEventListener('touchend', (e) => {
        endX = e.changedTouches[0].clientX;
        handleSwipe();
      });

      function handleSwipe() {
        const swipeThreshold = 50; // Mínimo de píxeles para considerar un deslizamiento
        
        if (startX - endX > swipeThreshold) {
          // Deslizamiento a la izquierda - siguiente
          let nextIndex = (currentIndex + 1) % cards.length;
          moveCarousel(nextIndex);
        } else if (endX - startX > swipeThreshold) {
          // Deslizamiento a la derecha - anterior
          let prevIndex = (currentIndex - 1 + cards.length) % cards.length;
          moveCarousel(prevIndex);
        }
      }
    });

    function enviarAltura() {
      const altura = document.body.scrollHeight;
      window.parent.postMessage({ height: altura }, "*");
    }

    // Enviar altura al cargar y al cambiar tamaño
    window.addEventListener('load', enviarAltura);
    window.addEventListener('resize', enviarAltura);
  </script>
</body>
</html>